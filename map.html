<!doctype html>
<!-- https://github.com/paulirish/html5-boilerplate/blob/master/index.html -->
<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
  <!-- meta element for compatibility mode needs to be before
        all elements except title & meta
        msdn.microsoft.com/en-us/library/cc288325(VS.85).aspx -->
  <meta charset="utf-8">
  
  <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
       Remove this if you use the .htaccess -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>The Free Python Job Board</title>
  <meta name="description" content="An international job board for Python roles">

  <!--  Because we have responsive styles, don't set device-width which makes rotation look weird
        and allow users to zoom-in/out as they wish -->
  <meta name="viewport" content="initial-scale=1">

  <link rel="shortcut icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/touch-icon-iphone.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/touch-icon-ipad.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/touch-icon-iphone-retina.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/touch-icon-ipad-retina.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/touch-icon-iphone6.png">
  <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="The Free Python Job Board's atom feed" />
  <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml"/>

    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/media/css/font.css">
  <link rel="stylesheet" href="/media/css/site.css">
      
<script type="text/javascript" src="//maps.googleapis.com/maps/api/js?key=AIzaSyCvUNmmqfyLM6ZXhyprecI3mEFP2e99cLQ"></script>
<script type="text/javascript" src="/media/js/libs/markcluster.js"></script>

<style>
  footer{
    position: fixed;
    left: 0; right: 0; bottom: 0;
    height: 2.2em;
    box-shadow: 0 -2px 2px rgba(0, 0, 0, 0.2);
  }
  #main header{
    position: fixed;
    left: 0; right: 0; top: 0;
    z-index: 10;
    box-shadow: 0 2px 2px rgba(0, 0, 0, 0.2);
  }
  #map-container{
    position: fixed;
    left: 0; right:0;
  }
  .gm-button-style{
    overflow: hidden;
    text-align: center;
    position: relative;
    color: rgb(86, 86, 86);
    font-family: Roboto, Arial, sans-serif;
    user-select: none;
    font-size: 11px;
    background-color: rgb(255, 255, 255);
    padding: 8px;
    border-bottom-right-radius: 2px;
    border-top-right-radius: 2px;
    background-clip: padding-box;
    box-shadow: rgba(0, 0, 0, 0.3) 0px 1px 4px -1px;
    min-width: 40px;
    border-left: 0px;
    margin: 10px;
  }
  .gm-button-style i{
    margin-bottom: 1px;
  }
  #location-warn{
    display: inline-block;
    text-align: center;
    position: relative;
    font-family: Roboto, Arial, sans-serif;
    padding: 8px 8px;
    color: red;
    background-color: rgb(255, 255, 255);
    box-shadow: rgba(0, 0, 0, 0.3) 0px 1px 4px -1px;
    margin: 10px 0;
  }
</style>
  </head>
<body id="map">
    <header>
    <div class="in">
      <div id="logo"><a href="/"><i class="i-pyjobslogo"></i></a></div>
      <div id="title"><a href="/">The Free <span>Python Job Board</span></a></div>
      <div class="sub">for the global Python community</div>
    </div>
  </header>
  <div id="container">
            <div id="main" role="main">
          <div class="controls">
  <div id=location-warn>
    Location Markers are approximate
  </div>
  <div id='returnlink' class="gm-button-style">
    <a href="/"><i class='i-list'></i> Return to list</a>
  </div>
</div>
<div id="map-container">
  <div id='map-el' style="height: 100%; width: 100%;"></div>
</div>
      </div>
      </div> <!--! end of #container -->
  <footer>
    <a class="about" href="https://www.github.com/pythonjobs/jobs">
      Have a job to advertise? Create a pull-request <i class="i-github"></i>
    </a>
      The Free Python Job Board - Hosted by
      <a href="https://www.github.com/pythonjobs/jobs" target="_blank">github</a>, generated with <a href="http://hyde.github.io/">hyde</a>.
  </footer>
        <!-- Javascript at the bottom for fast page loading -->
    <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if necessary -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.js"></script>
  <script>window.jQuery || document.write('<script src="/media/js/libs/jquery-1.5.1.min.js">\x3C/script>')</script>
  
        <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59980478-1', 'auto');
  ga('send', 'pageview');

</script>  
  
  <script type="text/javascript">
    var jobs = {};
                                      console.log(jobs);
    var MAP_OPTIONS = {
      center: { lat: 40, lng: 0},
      zoom: 1,
      styles: [
        {
          "featureType": "poi",
          "elementType": "labels",
          "stylers": [
            { "visibility": "off" }
          ]
        }
      ]
    };
    $(function() {
      var mapEl = $('#map-el');
      var containerEl = $('#map-container');
      var footerEl = $("footer");
      var headerEl = $("#main header");
      var homelink = $("#returnlink");
      var warntext = $("#location-warn")

      function resize() {
        var top = headerEl.outerHeight();
        var bottom = footerEl.position().top;

        containerEl.css({
          position: 'fixed',
          top: top + 'px',
          height: (bottom-top) + 'px'
        });
      }

      $(window).resize(resize);
      var map = new google.maps.Map(mapEl[0], MAP_OPTIONS);
      map.controls[google.maps.ControlPosition.TOP_RIGHT].push(homelink[0]);
      map.controls[google.maps.ControlPosition.TOP_RIGHT].push(warntext[0]);
      var bounds = new google.maps.LatLngBounds();
      var infoWindows = [];
      var markers = [];
      mapevent = google.maps.event.addListener;

      $.each(jobs, function(_, job_list) {
        var contents = [];
        var coords;
        $.each(job_list, function(_, job) {
          coords = job.coords;
          contents.push(job.content);
        });
        contents = contents.join('<hr/>');
        $.each(job_list, function(_, job) {
          var markerpos = new google.maps.LatLng(coords.lat, coords.lng);
          bounds.extend(markerpos);
          var infowindow = new google.maps.InfoWindow({
            content: contents
          });
          infoWindows.push(infowindow);
          var marker = new google.maps.Marker({position: markerpos,map: map});
          markers.push(marker)
          mapevent(marker, 'click', function() {
              $.each(infoWindows, function(_, el) {
                el.close();
              })
              infowindow.open(map, marker);
            });
        });
      });
      
      var markerCluster = new MarkerClusterer(map, markers, {
        zoomOnClick: false,
        styles: [{
          url: "/media/multi-marker.png",
          height: 46, width: 32,
          textColor: "#fff"
        }]
      });
      markerCluster.setGridSize(20);
      markerCluster.setMaxZoom(10);
      resize();
      map.fitBounds(bounds);
    })
  </script>
</body>
</html>